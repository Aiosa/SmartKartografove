(()=>{var __webpack_modules__={20:(module,__unused_webpack_exports,__webpack_require__)=>{eval("var MoveError = __webpack_require__(767);\nvar Tile = __webpack_require__(783);\nvar NullTile = __webpack_require__(250);\nvar gridSize = 11;\n\nfunction Board () {\n  this.grid = Board.makeGrid();\n  this.size = gridSize;\n}\n\nBoard.makeGrid = function () {\n  var grid = [];\n  for (var i = 0; i < gridSize; i++) {\n    grid.push([]);\n    for (var j = 0; j < gridSize; j++) {\n      grid[i].push(new NullTile([i,j], null));\n    }\n  }\n  return grid;\n};\n\nBoard.validPos = function (pos) {\n  return (\n    (0 <= pos[0]) && (pos[0] < gridSize) && (0 <= pos[1]) && (pos[1] < gridSize)\n  );\n};\n\nBoard.prototype.placeShape = function (shape) {\n  var coords = shape.coords;\n  if (this.emptyCoords(coords)) {\n    coords.forEach(function (row, rowIdx) {\n      row.forEach(function (tile, tileIdx) {\n        tile = new Tile([rowIdx, tileIdx], shape.color);\n      });\n    });\n  }\n};\n\nBoard.prototype.emptyCoords = function (coords) {\n  var self = this;\n  coords.forEach(function (row, rowIdx) {\n    row.forEach(function (tile, tileIdx) {\n      if (Board.validPos([rowIdx, tileIdx])) {\n        var tile = self.grid[rowIdx][tileIdx];\n        if (tile.empty) {\n          return false;\n        }\n      }\n    });\n  });\n  return true;\n};\n\nBoard.prototype.isOver = function () {\n  for (var rowIdx = 0; rowIdx < 3; rowIdx++) {\n    for (var colIdx = 0; colIdx < 3; colIdx++) {\n      if (this.isEmptyPos([rowIdx, colIdx])) {\n        return false;\n      }\n    }\n  }\n  return true;\n};\n\nmodule.exports = Board;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAuanMiLCJtYXBwaW5ncyI6IkFBQUEsZ0JBQWdCLG1CQUFPLENBQUMsR0FBYTtBQUNyQyxXQUFXLG1CQUFPLENBQUMsR0FBUTtBQUMzQixlQUFlLG1CQUFPLENBQUMsR0FBWTtBQUNuQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLGNBQWM7QUFDaEM7QUFDQSxvQkFBb0IsY0FBYztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0EsdUJBQXVCLFlBQVk7QUFDbkMseUJBQXlCLFlBQVk7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIi4vanMvbGliL2JvYXJkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBNb3ZlRXJyb3IgPSByZXF1aXJlKFwiLi9tb3ZlRXJyb3JcIik7XG52YXIgVGlsZSA9IHJlcXVpcmUoJy4vdGlsZScpO1xudmFyIE51bGxUaWxlID0gcmVxdWlyZSgnLi9udWxsVGlsZScpO1xudmFyIGdyaWRTaXplID0gMTE7XG5cbmZ1bmN0aW9uIEJvYXJkICgpIHtcbiAgdGhpcy5ncmlkID0gQm9hcmQubWFrZUdyaWQoKTtcbiAgdGhpcy5zaXplID0gZ3JpZFNpemU7XG59XG5cbkJvYXJkLm1ha2VHcmlkID0gZnVuY3Rpb24gKCkge1xuICB2YXIgZ3JpZCA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGdyaWRTaXplOyBpKyspIHtcbiAgICBncmlkLnB1c2goW10pO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgZ3JpZFNpemU7IGorKykge1xuICAgICAgZ3JpZFtpXS5wdXNoKG5ldyBOdWxsVGlsZShbaSxqXSwgbnVsbCkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZ3JpZDtcbn07XG5cbkJvYXJkLnZhbGlkUG9zID0gZnVuY3Rpb24gKHBvcykge1xuICByZXR1cm4gKFxuICAgICgwIDw9IHBvc1swXSkgJiYgKHBvc1swXSA8IGdyaWRTaXplKSAmJiAoMCA8PSBwb3NbMV0pICYmIChwb3NbMV0gPCBncmlkU2l6ZSlcbiAgKTtcbn07XG5cbkJvYXJkLnByb3RvdHlwZS5wbGFjZVNoYXBlID0gZnVuY3Rpb24gKHNoYXBlKSB7XG4gIHZhciBjb29yZHMgPSBzaGFwZS5jb29yZHM7XG4gIGlmICh0aGlzLmVtcHR5Q29vcmRzKGNvb3JkcykpIHtcbiAgICBjb29yZHMuZm9yRWFjaChmdW5jdGlvbiAocm93LCByb3dJZHgpIHtcbiAgICAgIHJvdy5mb3JFYWNoKGZ1bmN0aW9uICh0aWxlLCB0aWxlSWR4KSB7XG4gICAgICAgIHRpbGUgPSBuZXcgVGlsZShbcm93SWR4LCB0aWxlSWR4XSwgc2hhcGUuY29sb3IpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn07XG5cbkJvYXJkLnByb3RvdHlwZS5lbXB0eUNvb3JkcyA9IGZ1bmN0aW9uIChjb29yZHMpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICBjb29yZHMuZm9yRWFjaChmdW5jdGlvbiAocm93LCByb3dJZHgpIHtcbiAgICByb3cuZm9yRWFjaChmdW5jdGlvbiAodGlsZSwgdGlsZUlkeCkge1xuICAgICAgaWYgKEJvYXJkLnZhbGlkUG9zKFtyb3dJZHgsIHRpbGVJZHhdKSkge1xuICAgICAgICB2YXIgdGlsZSA9IHNlbGYuZ3JpZFtyb3dJZHhdW3RpbGVJZHhdO1xuICAgICAgICBpZiAodGlsZS5lbXB0eSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgcmV0dXJuIHRydWU7XG59O1xuXG5Cb2FyZC5wcm90b3R5cGUuaXNPdmVyID0gZnVuY3Rpb24gKCkge1xuICBmb3IgKHZhciByb3dJZHggPSAwOyByb3dJZHggPCAzOyByb3dJZHgrKykge1xuICAgIGZvciAodmFyIGNvbElkeCA9IDA7IGNvbElkeCA8IDM7IGNvbElkeCsrKSB7XG4gICAgICBpZiAodGhpcy5pc0VtcHR5UG9zKFtyb3dJZHgsIGNvbElkeF0pKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJvYXJkO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///20\n")},743:(module,__unused_webpack_exports,__webpack_require__)=>{eval("var Board = __webpack_require__(20);\nvar Tray = __webpack_require__(967);\nvar MoveError = __webpack_require__(767);\n\nfunction Game (map, items, mountainData, mountains) {\n  this.board = new Board();\n\n  let i = 0;\n  this.trays = [];\n  for (const item of (items || [])) {\n    //index 0, tray class 1\n    this.trays[i] = new Tray(items[i++], `tray${i}`);\n  }\n\n  this.score = 0;\n  this.running = false;\n\n  this.map = map;\n  this.mountains = mountains;\n  this.mountainData = mountainData;\n}\n\nGame.prototype.isOver = function () {\n  const over = this.board.isOver();\n  if (over) {\n    if (this.clbck) this.clbck();\n    delete this.clbck;\n    this.running = false;\n  }\n  return over;\n};\n\nGame.prototype.playMove = function () {\n  // this.board.placeShape(this.tray.shape);\n};\n\nGame.prototype.run = function (gameCompletionCallback) {\n  this.running = true;\n  this.clbck = gameCompletionCallback;\n};\n\n\nmodule.exports = Game;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzQzLmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksbUJBQU8sQ0FBQyxFQUFTO0FBQzdCLFdBQVcsbUJBQU8sQ0FBQyxHQUFRO0FBQzNCLGdCQUFnQixtQkFBTyxDQUFDLEdBQWE7O0FBRXJDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsRUFBRTtBQUNsRDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBIiwic291cmNlcyI6WyIuL2pzL2xpYi9nYW1lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBCb2FyZCA9IHJlcXVpcmUoXCIuL2JvYXJkXCIpO1xudmFyIFRyYXkgPSByZXF1aXJlKFwiLi90cmF5XCIpO1xudmFyIE1vdmVFcnJvciA9IHJlcXVpcmUoXCIuL21vdmVFcnJvclwiKTtcblxuZnVuY3Rpb24gR2FtZSAobWFwLCBpdGVtcywgbW91bnRhaW5EYXRhLCBtb3VudGFpbnMpIHtcbiAgdGhpcy5ib2FyZCA9IG5ldyBCb2FyZCgpO1xuXG4gIGxldCBpID0gMDtcbiAgdGhpcy50cmF5cyA9IFtdO1xuICBmb3IgKGNvbnN0IGl0ZW0gb2YgKGl0ZW1zIHx8IFtdKSkge1xuICAgIC8vaW5kZXggMCwgdHJheSBjbGFzcyAxXG4gICAgdGhpcy50cmF5c1tpXSA9IG5ldyBUcmF5KGl0ZW1zW2krK10sIGB0cmF5JHtpfWApO1xuICB9XG5cbiAgdGhpcy5zY29yZSA9IDA7XG4gIHRoaXMucnVubmluZyA9IGZhbHNlO1xuXG4gIHRoaXMubWFwID0gbWFwO1xuICB0aGlzLm1vdW50YWlucyA9IG1vdW50YWlucztcbiAgdGhpcy5tb3VudGFpbkRhdGEgPSBtb3VudGFpbkRhdGE7XG59XG5cbkdhbWUucHJvdG90eXBlLmlzT3ZlciA9IGZ1bmN0aW9uICgpIHtcbiAgY29uc3Qgb3ZlciA9IHRoaXMuYm9hcmQuaXNPdmVyKCk7XG4gIGlmIChvdmVyKSB7XG4gICAgaWYgKHRoaXMuY2xiY2spIHRoaXMuY2xiY2soKTtcbiAgICBkZWxldGUgdGhpcy5jbGJjaztcbiAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZTtcbiAgfVxuICByZXR1cm4gb3Zlcjtcbn07XG5cbkdhbWUucHJvdG90eXBlLnBsYXlNb3ZlID0gZnVuY3Rpb24gKCkge1xuICAvLyB0aGlzLmJvYXJkLnBsYWNlU2hhcGUodGhpcy50cmF5LnNoYXBlKTtcbn07XG5cbkdhbWUucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uIChnYW1lQ29tcGxldGlvbkNhbGxiYWNrKSB7XG4gIHRoaXMucnVubmluZyA9IHRydWU7XG4gIHRoaXMuY2xiY2sgPSBnYW1lQ29tcGxldGlvbkNhbGxiYWNrO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///743\n")},767:module=>{eval("function MoveError (msg) {\n  this.msg = msg;\n}\n\nmodule.exports = MoveError;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzY3LmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTs7QUFFQSIsInNvdXJjZXMiOlsiLi9qcy9saWIvbW92ZUVycm9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIE1vdmVFcnJvciAobXNnKSB7XG4gIHRoaXMubXNnID0gbXNnO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IE1vdmVFcnJvcjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///767\n")},250:module=>{eval("function NullTile (pos, color) {\n  this.pos = pos;\n  this.color = color;\n  this.empty = true;\n};\n\nmodule.exports = NullTile;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUwLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIi4vanMvbGliL251bGxUaWxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIE51bGxUaWxlIChwb3MsIGNvbG9yKSB7XG4gIHRoaXMucG9zID0gcG9zO1xuICB0aGlzLmNvbG9yID0gY29sb3I7XG4gIHRoaXMuZW1wdHkgPSB0cnVlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBOdWxsVGlsZTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///250\n")},654:module=>{eval("Array.prototype.random = function () {\n  return this[Math.floor(Math.random() * this.length)];\n}\n\nfunction Shape (data) {\n\t$.extend(this, data);\n};\n\nShape.prototype.rotateRight = function(right) {\n  const coords = [...this.coords];\n\n  function rotate(arr) {\n    for (let c of arr) {\n      const t = c[0];\n      c[0] = -c[1];\n      c[1] = t; \n    }\n  }\n\n  rotate(this.coords);\n  if (this.scoords) rotate(this.scoords);\n\n  //move to corner up\n  let mx = Math.min(...this.coords.map(c => c[0]));\n  let my = Math.min(...this.coords.map(c => c[1]));\n  if (this.scoords) {\n    mx = Math.min(mx, ...this.scoords.map(c => c[0]));\n    my = Math.min(my, ...this.scoords.map(c => c[1]));\n  }\n\n  for (let c of this.coords) {\n    c[0] = c[0]-mx;\n    c[1] = c[1]-my; \n  }\n\n  if (this.scoords) {\n    for (let c of this.scoords) {\n      c[0] = c[0]-mx;\n      c[1] = c[1]-my; \n    }\n  }\n};\n\nShape.prototype.export = function(props=['color', 'coords', 'image', 'corner', 'placed', 'card_uid', 'scoords', 'monster']) {\n\n  const result = {};\n  Object.entries(this).forEach(([k,v]) => {\n    if (props.some(x => x === k)) result[k]=v;\n  });\n  return result;\n};\n\nShape.prototype.flip = function(horizontal) {\n  let mx = Math.max(...this.coords.map(c => c[0]));\n  let my = Math.max(...this.coords.map(c => c[1]));\n  if (this.scoords) {\n    mx = Math.max(mx, ...this.scoords.map(c => c[0]));\n    my = Math.max(my, ...this.scoords.map(c => c[1]));\n    this.scoords = this.scoords.map(pos => horizontal ? [mx - pos[0], pos[1]] : [pos[0], my - pos[1]]);\n  }\n  this.coords = this.coords.map(pos => horizontal ? [mx - pos[0], pos[1]] : [pos[0], my - pos[1]]);\n};\n\nmodule.exports = Shape;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjU0LmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIuL2pzL2xpYi9zaGFwZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJBcnJheS5wcm90b3R5cGUucmFuZG9tID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLmxlbmd0aCldO1xufVxuXG5mdW5jdGlvbiBTaGFwZSAoZGF0YSkge1xuXHQkLmV4dGVuZCh0aGlzLCBkYXRhKTtcbn07XG5cblNoYXBlLnByb3RvdHlwZS5yb3RhdGVSaWdodCA9IGZ1bmN0aW9uKHJpZ2h0KSB7XG4gIGNvbnN0IGNvb3JkcyA9IFsuLi50aGlzLmNvb3Jkc107XG5cbiAgZnVuY3Rpb24gcm90YXRlKGFycikge1xuICAgIGZvciAobGV0IGMgb2YgYXJyKSB7XG4gICAgICBjb25zdCB0ID0gY1swXTtcbiAgICAgIGNbMF0gPSAtY1sxXTtcbiAgICAgIGNbMV0gPSB0OyBcbiAgICB9XG4gIH1cblxuICByb3RhdGUodGhpcy5jb29yZHMpO1xuICBpZiAodGhpcy5zY29vcmRzKSByb3RhdGUodGhpcy5zY29vcmRzKTtcblxuICAvL21vdmUgdG8gY29ybmVyIHVwXG4gIGxldCBteCA9IE1hdGgubWluKC4uLnRoaXMuY29vcmRzLm1hcChjID0+IGNbMF0pKTtcbiAgbGV0IG15ID0gTWF0aC5taW4oLi4udGhpcy5jb29yZHMubWFwKGMgPT4gY1sxXSkpO1xuICBpZiAodGhpcy5zY29vcmRzKSB7XG4gICAgbXggPSBNYXRoLm1pbihteCwgLi4udGhpcy5zY29vcmRzLm1hcChjID0+IGNbMF0pKTtcbiAgICBteSA9IE1hdGgubWluKG15LCAuLi50aGlzLnNjb29yZHMubWFwKGMgPT4gY1sxXSkpO1xuICB9XG5cbiAgZm9yIChsZXQgYyBvZiB0aGlzLmNvb3Jkcykge1xuICAgIGNbMF0gPSBjWzBdLW14O1xuICAgIGNbMV0gPSBjWzFdLW15OyBcbiAgfVxuXG4gIGlmICh0aGlzLnNjb29yZHMpIHtcbiAgICBmb3IgKGxldCBjIG9mIHRoaXMuc2Nvb3Jkcykge1xuICAgICAgY1swXSA9IGNbMF0tbXg7XG4gICAgICBjWzFdID0gY1sxXS1teTsgXG4gICAgfVxuICB9XG59O1xuXG5TaGFwZS5wcm90b3R5cGUuZXhwb3J0ID0gZnVuY3Rpb24ocHJvcHM9Wydjb2xvcicsICdjb29yZHMnLCAnaW1hZ2UnLCAnY29ybmVyJywgJ3BsYWNlZCcsICdjYXJkX3VpZCcsICdzY29vcmRzJywgJ21vbnN0ZXInXSkge1xuXG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xuICBPYmplY3QuZW50cmllcyh0aGlzKS5mb3JFYWNoKChbayx2XSkgPT4ge1xuICAgIGlmIChwcm9wcy5zb21lKHggPT4geCA9PT0gaykpIHJlc3VsdFtrXT12O1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cblNoYXBlLnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24oaG9yaXpvbnRhbCkge1xuICBsZXQgbXggPSBNYXRoLm1heCguLi50aGlzLmNvb3Jkcy5tYXAoYyA9PiBjWzBdKSk7XG4gIGxldCBteSA9IE1hdGgubWF4KC4uLnRoaXMuY29vcmRzLm1hcChjID0+IGNbMV0pKTtcbiAgaWYgKHRoaXMuc2Nvb3Jkcykge1xuICAgIG14ID0gTWF0aC5tYXgobXgsIC4uLnRoaXMuc2Nvb3Jkcy5tYXAoYyA9PiBjWzBdKSk7XG4gICAgbXkgPSBNYXRoLm1heChteSwgLi4udGhpcy5zY29vcmRzLm1hcChjID0+IGNbMV0pKTtcbiAgICB0aGlzLnNjb29yZHMgPSB0aGlzLnNjb29yZHMubWFwKHBvcyA9PiBob3Jpem9udGFsID8gW214IC0gcG9zWzBdLCBwb3NbMV1dIDogW3Bvc1swXSwgbXkgLSBwb3NbMV1dKTtcbiAgfVxuICB0aGlzLmNvb3JkcyA9IHRoaXMuY29vcmRzLm1hcChwb3MgPT4gaG9yaXpvbnRhbCA/IFtteCAtIHBvc1swXSwgcG9zWzFdXSA6IFtwb3NbMF0sIG15IC0gcG9zWzFdXSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNoYXBlO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///654\n")},783:module=>{eval("function Tile (pos, color, image=undefined) {\n  this.pos = pos;\n  this.color = color;\n  this.empty = false;\n  this.image = image;\n};\n\nTile.size = 25;\n\nmodule.exports = Tile;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzgzLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSIsInNvdXJjZXMiOlsiLi9qcy9saWIvdGlsZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBUaWxlIChwb3MsIGNvbG9yLCBpbWFnZT11bmRlZmluZWQpIHtcbiAgdGhpcy5wb3MgPSBwb3M7XG4gIHRoaXMuY29sb3IgPSBjb2xvcjtcbiAgdGhpcy5lbXB0eSA9IGZhbHNlO1xuICB0aGlzLmltYWdlID0gaW1hZ2U7XG59O1xuXG5UaWxlLnNpemUgPSAyNTtcblxubW9kdWxlLmV4cG9ydHMgPSBUaWxlO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///783\n")},967:(module,__unused_webpack_exports,__webpack_require__)=>{eval('var Shape = __webpack_require__(654);\nvar Tile = __webpack_require__(783);\nvar NullTile = __webpack_require__(250);\n\nvar count = 0;\nvar COLORS = ["red", "blue", "yellow", "green", "purple"];\n\nfunction Tray (shapeData, cls) {\n  this.size = Tray.size;\n  this.class= cls;\n\n  //override color to distinguish pieces\n  shapeData.color = COLORS[count++ % COLORS.length];\n\n  this.grid = Tray.makeGrid(this.size);\n  this.shape = new Shape(shapeData);\n  this.shape.tray = this;\n  this.placeShape(this.shape);\n}\n\nTray.size = 4;\n\nTray.makeGrid = function (size) {\n  var grid = [];\n  for (var i = 0; i < size; i++) {\n    grid.push([]);\n    for (var j = 0; j < size; j++) {\n      grid[i].push(new NullTile([i,j], null));\n    }\n  }\n  return grid;\n};\n\nTray.prototype.placeShape = function (shape) {\n  this.shape = shape;\n  shape.coords.forEach(function (pos) {\n    this.grid[pos[0]][pos[1]] = new Tile(pos, shape.color, shape.image);\n  }.bind(this));\n\n  shape.scoords?.forEach(function (pos) {\n    this.grid[pos[0]][pos[1]].scord = true;\n  }.bind(this));\n};\n\nTray.prototype.rotateRight = function() {\n  this.shape.rotateRight();\n  this.grid = Tray.makeGrid(this.size);\n  this.placeShape(this.shape);\n};\n\nTray.prototype.flip = function() {\n  this.shape.flip();\n  this.grid = Tray.makeGrid(this.size);\n  this.placeShape(this.shape);\n};\n\nmodule.exports = Tray;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTY3LmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksbUJBQU8sQ0FBQyxHQUFTO0FBQzdCLFdBQVcsbUJBQU8sQ0FBQyxHQUFRO0FBQzNCLGVBQWUsbUJBQU8sQ0FBQyxHQUFZOztBQUVuQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQixVQUFVO0FBQzVCO0FBQ0Esb0JBQW9CLFVBQVU7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIi4vanMvbGliL3RyYXkuanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIFNoYXBlID0gcmVxdWlyZSgnLi9zaGFwZScpO1xudmFyIFRpbGUgPSByZXF1aXJlKCcuL3RpbGUnKTtcbnZhciBOdWxsVGlsZSA9IHJlcXVpcmUoJy4vbnVsbFRpbGUnKTtcblxudmFyIGNvdW50ID0gMDtcbnZhciBDT0xPUlMgPSBbXCJyZWRcIiwgXCJibHVlXCIsIFwieWVsbG93XCIsIFwiZ3JlZW5cIiwgXCJwdXJwbGVcIl07XG5cbmZ1bmN0aW9uIFRyYXkgKHNoYXBlRGF0YSwgY2xzKSB7XG4gIHRoaXMuc2l6ZSA9IFRyYXkuc2l6ZTtcbiAgdGhpcy5jbGFzcz0gY2xzO1xuXG4gIC8vb3ZlcnJpZGUgY29sb3IgdG8gZGlzdGluZ3Vpc2ggcGllY2VzXG4gIHNoYXBlRGF0YS5jb2xvciA9IENPTE9SU1tjb3VudCsrICUgQ09MT1JTLmxlbmd0aF07XG5cbiAgdGhpcy5ncmlkID0gVHJheS5tYWtlR3JpZCh0aGlzLnNpemUpO1xuICB0aGlzLnNoYXBlID0gbmV3IFNoYXBlKHNoYXBlRGF0YSk7XG4gIHRoaXMuc2hhcGUudHJheSA9IHRoaXM7XG4gIHRoaXMucGxhY2VTaGFwZSh0aGlzLnNoYXBlKTtcbn1cblxuVHJheS5zaXplID0gNDtcblxuVHJheS5tYWtlR3JpZCA9IGZ1bmN0aW9uIChzaXplKSB7XG4gIHZhciBncmlkID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgZ3JpZC5wdXNoKFtdKTtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNpemU7IGorKykge1xuICAgICAgZ3JpZFtpXS5wdXNoKG5ldyBOdWxsVGlsZShbaSxqXSwgbnVsbCkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZ3JpZDtcbn07XG5cblRyYXkucHJvdG90eXBlLnBsYWNlU2hhcGUgPSBmdW5jdGlvbiAoc2hhcGUpIHtcbiAgdGhpcy5zaGFwZSA9IHNoYXBlO1xuICBzaGFwZS5jb29yZHMuZm9yRWFjaChmdW5jdGlvbiAocG9zKSB7XG4gICAgdGhpcy5ncmlkW3Bvc1swXV1bcG9zWzFdXSA9IG5ldyBUaWxlKHBvcywgc2hhcGUuY29sb3IsIHNoYXBlLmltYWdlKTtcbiAgfS5iaW5kKHRoaXMpKTtcblxuICBzaGFwZS5zY29vcmRzPy5mb3JFYWNoKGZ1bmN0aW9uIChwb3MpIHtcbiAgICB0aGlzLmdyaWRbcG9zWzBdXVtwb3NbMV1dLnNjb3JkID0gdHJ1ZTtcbiAgfS5iaW5kKHRoaXMpKTtcbn07XG5cblRyYXkucHJvdG90eXBlLnJvdGF0ZVJpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuc2hhcGUucm90YXRlUmlnaHQoKTtcbiAgdGhpcy5ncmlkID0gVHJheS5tYWtlR3JpZCh0aGlzLnNpemUpO1xuICB0aGlzLnBsYWNlU2hhcGUodGhpcy5zaGFwZSk7XG59O1xuXG5UcmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuc2hhcGUuZmxpcCgpO1xuICB0aGlzLmdyaWQgPSBUcmF5Lm1ha2VHcmlkKHRoaXMuc2l6ZSk7XG4gIHRoaXMucGxhY2VTaGFwZSh0aGlzLnNoYXBlKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVHJheTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///967\n')},301:(module,__unused_webpack_exports,__webpack_require__)=>{eval("const Tile = __webpack_require__(783);\nconst Tray = __webpack_require__(967);\nconst Shape = __webpack_require__(654);\n\n//interaction: 'all', 'monster', 'none'\nvar View = function (game, $el, interaction, imgRootPath=\"\") {\n  this.game = game;\n  this.board = game.board;\n  this.$el = $el;\n  this.imgRootPath = imgRootPath;\n  this.interaction = interaction;\n\n  //one tray above\n  var $container = $(\"<div>\");\n  $container.addClass('trays d-flex flex-row flex-wrap');\n  this.$el.append($container);\n  this.$trayEl = $container;\n\n  this.activeShape = undefined;\n  this.grid = [];\n  this.setupBoard();\n\n   //one tray below\n  $container = $(\"<div>\");\n  $container.addClass('trays d-flex flex-row flex-wrap');\n  this.$el.append($container);\n  this.$trayEl2 = $container;\n\n  this.setupTrays();\n};\n\nView.prototype.setupTrays = function (pieces) {\n  function placedShape(tray, self) {\n    if (!tray || !tray.shape.placed|| !tray.shape.corner) return;\n    const $tray = $(\".\" + tray.class);\n    const shape = tray.shape;\n\n    self.activeShape = shape;\n    self.activeTray = tray;\n    if (self.placeShapeIfPossible(shape.corner)) {\n      $tray[0].style.visibility = 'hidden';\n    } \n  }\n\n  for (let i = 0; i < this.game.trays.length; i++) {\n    const tray = this.game.trays[i];\n    tray._order = i;\n\n    this.setupPieceTray(tray);\n    placedShape(tray, this);\n  }\n}\n\nView.prototype.setupBoard = function () {\n  var self = this;\n  var $ul = $(\"<ul>\").addClass(\"group position-relative\");\n\n  function isActiveTrayForCoords(tray, i, j) {\n    if (!tray || self.interaction == 'none') return false;\n\n    if ((self.interaction == 'monster' && !tray.shape.monster) \n    || (self.interaction != 'monster' && tray.shape.monster)) {\n      return false;\n    }\n\n    const coords = tray.shape.transformCoords;\n    return coords && coords.some(c => [i, j].equals(c));\n  }\n\n  function createCounterCell(letter) {\n    var $li = $(\"<li>\");  \n    $li.css({width: Tile.size, height: Tile.size, background: 'transparent'})\n    $li.html(letter);\n    //need to have due to testing, but far away to say 'not able to place'\n    $li.data(\"pos\", [-99999,-99999]);\n    $li.addClass('border-counting');\n    $ul.append($li);\n  }\n\n  //empty corner:\n  createCounterCell();\n\n  this.board.grid.forEach(function (row, rowIdx) {\n    createCounterCell(String.fromCharCode(rowIdx+65));\n  });\n\n  this.board.grid.forEach(function (row, rowIdx) {\n    row.forEach(function (tile, tileIdx) {\n      \n      if (tileIdx == 0) {\n        createCounterCell(rowIdx+1);\n      }\n\n      var $li = $(\"<li>\");\n      const pos = [rowIdx, tileIdx];\n\n      $li.css({width: Tile.size, height: Tile.size})\n      $li.data(\"pos\", pos);\n\n      const mapPiece = self.game.map[rowIdx][tileIdx] || {};\n\n      if (mapPiece.scord) { //special non-collision coord\n        $li.data(\"scord\", mapPiece.scord);\n        $li.addClass('special-coord');\n      }\n\n      if (self.game.mountains.some(m => m.equals(pos))) { //mountain\n        $li.data(\"color\", self.game.mountainData.color);\n        $li.data(\"image\", self.game.mountainData.image);\n        $li.css('background', \"url('\"+ self.imgRootPath+self.game.mountainData.image+\"')\");\n        $li.addClass(\"mountain\");\n\n      } else if (mapPiece.color) { //old piece\n        $li.data(\"color\", mapPiece.color);\n        $li.data(\"image\", mapPiece.image);\n        $li.css('background', \"url('\"+self.imgRootPath+mapPiece.image+\"')\");\n\n        if (mapPiece.monster) {\n          $li.addClass('monster');\n        }\n\n      } else { //empty\n        \n        $li.addClass('dropzone');\n\n          self.addDroppableListener($li);  \n          $li.on('click', (e) => {\n            //existing shapes can be removed\n            const tray = self.game.trays.find(tray => isActiveTrayForCoords(tray, rowIdx, tileIdx));\n    \n            if (tray) {\n              self.revertRender(tray.shape);\n              self.setupPieceTray(tray);\n              tray.shape.placed = false;\n              tray.shape.corner = undefined; \n              tray.shape.transformCoords = undefined;\n            }\n          })\n      }\n\n      $ul.append($li);\n    });\n  });\n\n  $ul.css('width', (this.board.size+1) * (Tile.size+1) + 5);\n\n  this.$el.append($ul);\n};\n\nView.prototype.addDroppableListener = function ($li) {\n\n  const self = this;\n  interact('.dropzone').dropzone({\n    // Require a 75% element overlap for a drop to be possible\n    overlap: 0.4,\n  \n \n    // ondropactivate: function (event) {\n    //   self.activeTray = tray;\n    // },\n    ondragenter: function (event) {\n      var draggableElement = event.relatedTarget\n      var dropzoneElement = event.target\n      // feedback the possibility of a drop\n      dropzoneElement.classList.add('drop-target')\n      draggableElement.classList.add('can-drop')\n\n    },\n    ondragleave: function (event) {\n      // remove the drop feedback style\n      event.target.classList.remove('drop-target')\n      event.relatedTarget.classList.remove('can-drop')\n\n\n    },\n    ondrop: function (event) {\n      const dragTarget = $(event.relatedTarget).data('pos');\n      const dropTarget = $(event.target).data('pos');\n\n      //we might be dragging by element [2,3] -> always get left top\n      const corner = [dropTarget[0]-dragTarget[0], dropTarget[1]-dragTarget[1]];\n  \n      if (self.placeShapeIfPossible(corner)) {\n       \n        self.activeShape.placed = true;\n        self.activeShape.corner = corner;\n        event.relatedTarget.parentElement.style.visibility = 'hidden';\n      }\n    },\n    ondropdeactivate: function (event) {\n      // remove active dropzone feedback\n      event.target.classList.remove('drop-target')\n    }\n  })\n\n};\n\nView.prototype.getCurrentItems = function () {\n  return this.game.trays.map(t => t.shape.export());\n}\n\n\nView.prototype.transformCoords = function (startPos, coords) {\n  return coords.map(function (pos) {\n    return [startPos[0]+pos[0], startPos[1]+pos[1]];\n  });\n};\n\nView.prototype.revertRender = function (shape) {\n  if (!shape.corner || !shape.transformCoords) {\n    console.error(\"Attempt to revert unplaced tile!\", shape);\n    return;\n  }\n\n  const self = this;\n  $('.group > li').each(function (idx, li) {\n    var $li = $(li);\n    shape.transformCoords.forEach(function (pos, i) {\n      if (pos.equals($li.data('pos'))) {\n        $li.css(\"background\", \"\");\n        $li.css('outline', 'unset');\n        $li.removeData('color');\n        $li.removeClass('active monster'); //monster - just to be sure\n      }  \n    });\n\n    if (shape?.scoords) {\n      for (let pos of self.transformCoords(shape.corner, shape.scoords)) {\n        if (pos.equals($li.data('pos'))) {\n          $li.removeClass('special-coord');\n        }\n       \n      }\n    }\n  \n  }); \n  $('.'+shape.tray.class).css('visibility', 'hidden');\n};\n\nView.prototype.placeShapeIfPossible = function (startPos) {\n  var self = this;\n\n  this.activeShape = this.activeTray.shape;\n\n  var coords = this.activeShape.coords;\n  var maxLen = this.game.board.size;\n\n  this.activeShape.transformCoords = this.transformCoords(startPos, coords);\n  for (let pos of this.activeShape.transformCoords) {\n    if (!this.activeShape || pos[0] < 0 || pos[1] < 0 || pos[0] >= maxLen || pos[1] >= maxLen) {\n      this.activeShape = undefined;\n      return;\n    }\n    \n    $('.group > li').each(function (idx, li) {\n      var $li = $(li);\n      if (!pos.equals($li.data('pos'))) return;\n      if (($li.data('color') !== undefined)) {\n        self.activeShape = undefined;\n      }\n    });\n  }\n\n  if (!this.activeShape) return false;\n  //else render\n\n  var color = this.activeShape.color;\n  var image = this.activeShape.image;\n  var monster = this.activeShape.monster;\n\n  $('.group > li').each(function (idx, li) {\n    const $li = $(li),\n      tilePos = $li.data('pos');\n\n    for (let pos of self.activeShape.transformCoords) {\n      if (pos.equals(tilePos)) {\n        $li.css('background', \"url('\"+self.imgRootPath+image+\"')\");\n        $li.data('color', color);\n        $li.css('outline', '1px solid ' + color);\n        $li.addClass('active');\n\n        if (monster) {\n          $li.addClass('monster');\n        }\n      }\n    }\n\n    if (self.activeShape?.scoords) {\n      for (let pos of self.transformCoords(startPos, self.activeShape.scoords)) {\n        if (pos.equals(tilePos)) {\n          $li.addClass('special-coord');\n        }\n      }\n    }\n  });\n\n  this.game.playMove();\n  return true;\n};\n\nView.prototype.full = function (arr) {\n  var full = true;\n  arr.forEach(function (li) {\n    var $li = $(li);\n    if ($li.data('color') === undefined) {\n      full = false;\n    }\n  });\n  return full;\n};\n\n// View.prototype.clear = function (arr) {\n//   this.game.score += 93\n//   var self = this;\n//   arr.forEach(function (li) {\n//     var $li = $(li);\n//     $li.animate({ 'background': '#ccc' }, 500, function() {\n//       $li.removeAttr('style');\n//       $li.removeData('color');\n//       $li.removeClass('piece');\n// \t\t});\n//   });\n\n//   return true;\n// };\n\nView.prototype.setupPieceTray = function (tray) {\n\n  const $parent = tray._order > 2 ? this.$trayEl2 : this.$trayEl;\n\n  if (!tray) {\n    var $c = $(\"<ul class='d-flex border-1 rounded-2 p-1 m-1 position-relative'>\");\n    $c.css('display', 'inline-block');\n    $c.css('background', '#eeea');\n\n    for (let i = 0; i < Tray.size; i++) {\n      for (let j = 0; j < Tray.size; j++) {\n        var $li = $(\"<li>\");\n        $li.css({width: Tile.size, height: Tile.size})\n  \n        if ((i+j)%3==0) {\n          $li.css('background', \"color:#ccc\");\n        } else {\n          $li.css('background', 'transparent');\n        }\n  \n        $li.data(\"pos\", [-1,-1]);\n        $c.append($li);\n      }\n    }\n    $c.css('width', Tray.size * (Tile.size+1) + 10);\n    $parent.append($c);\n    return;\n  }\n\n\n  var self = this;\n  var $ul = $(\"<ul class='border-1 rounded-1 p-1 m-1 position-relative'>\");\n  $ul.addClass(tray.class);\n  $ul.css('background', '#eeea');\n  $ul.css('z-index', '999');\n\n  tray.grid.forEach(function (row, rowIdx) {\n    row.forEach(function (tile, tileIdx) {\n      var $li = $(\"<li>\");\n      $li.css({width: Tile.size, height: Tile.size});\n\n      if (tile.scord) { //special non-collision coord\n        $li.data(\"scord\", tile.scord);\n        $li.addClass('special-coord');\n      }\n\n      if (!tile.empty) {\n        $li.data(\"color\", tile.color);\n        $li.data(\"image\", tile.image);\n        $li.css('background', \"url('\"+self.imgRootPath+tile.image+\"')\");\n        $li.addClass(\"piece\");\n      } else {\n        $li.css('background', 'transparent');\n      }\n\n      $li.data(\"pos\", [rowIdx, tileIdx]);\n      $ul.append($li);\n    });\n  });\n  $ul.css('width', tray.size * (Tile.size+1) + 10);\n\n\n  var timer = 0;\n  function pointDown() {\n    timer = Date.now();\n  }\n\n  function pointUp() {\n    const d = Date.now() - timer;\n    timer = 0;\n\n    const moved = $ul[0]._moving;\n    $ul[0]._moving=false;\n    if ($ul.css('visibility')!='visible' || moved) return;\n    \n    if (d < 120) {\n      tray.rotateRight();\n    } else {\n      tray.flip();\n    }\n    self.setupPieceTray(tray);\n  }\n\n  $ul[0].addEventListener(\"touchstart\", pointDown, false);\n  $ul[0].addEventListener('touchend', pointUp,false);\n\n  $ul.on('click', e => {\n    \n  })\n\n  $elem = $(`.${tray.class}`);\n  if ($elem.length) {\n    $elem.replaceWith($ul);\n  } else {\n    var $c = $(\"<div>\");\n    $c.css('display', 'inline-block');\n    $c.append($ul);\n    $parent.append($c);\n  }\n\n  this.addDraggableListener(tray);\n};\n\n\nView.prototype.addDraggableListener = function (tray) {\n\n  const cls = tray.class;\n  const self = this;\n\n  if (this.interaction == 'none') return;\n  const selector = this.interaction == 'monster' ? `.${cls} > li.monster` : `.${cls} > li.piece`;\n  \n  interact(`.${cls} > li.piece`).draggable({\n    inertia: true,\n    modifiers: [\n      interact.modifiers.restrictRect({\n        restriction: 'parent',\n        endOnly: true\n      })\n    ],\n    autoScroll: true,\n    // dragMoveListener from the dragging demo above\n    listeners: { \n      move: (event) => {\n        const node = event.target.parentElement;\n        // keep the dragged position in the data-x/data-y attributes\n        var x = (parseFloat(node.getAttribute('data-x')) || 0) + event.dx\n        var y = (parseFloat(node.getAttribute('data-y')) || 0) + event.dy\n      \n        // translate the element\n        node.style.transform = 'translate(' + x + 'px, ' + y + 'px)'\n      \n        // update the posiion attributes\n        node.setAttribute('data-x', x)\n        node.setAttribute('data-y', y)\n      },\n      start: (event) => {\n        self.activeTray = tray;\n        timer = Date.now();\n\n        const node = event.target.parentElement;\n        node._moving=true;\n        node.style.background = 'transparent';\n        self.$el.css({\n          \"touch-action\": \"none\", \"user-select\": \"none\"\n        });\n        \n      }\n    }\n  }).on('dragend', event=> {\n    self.activeTray = null;\n\n    const node = event.target.parentElement;\n    node.style.transform = 'initial';\n    node.setAttribute('data-x', 0);\n    node.setAttribute('data-y', 0);\n    node.style.background = '#eeea';\n\n    self.$el.css({\n      \"touch-action\": \"\", \"user-select\": \"\"\n    });\n  })\n  \n\n\n  // $(`.${cls} > li.piece`).draggable({\n  //   cursor: 'pointer',\n  //   revert: false,\n  //   helper: function(e) {\n  //     var helperList = $('<ul class=\"draggable-helper\">');\n  //     helperList.append($(`.${cls} > li`).clone());\n  //     return helperList;\n  //   },\n  //   start: function (e, ui) {\n  //     self.activeTray = tray;\n  //   },\n  //   drag: function (e, ui) {\n  //     $(`.${cls} > li.piece`).css('visibility', 'hidden');\n  //   },\n  //   stop: function(e, ui) {\n  //     if (!self.activeShape) {\n  //       $(`.${cls} > li.piece`).css('visibility', 'visible');\n  //     }\n\t// \t},\n  //   cursorAt: { top: 40 }\n  // });\n};\n\nArray.prototype.equals = function (array) {\n  if (!array)\n      return false;\n  if (this.length != array.length)\n      return false;\n  for (var i = 0, l=this.length; i < l; i++) {\n      if (this[i] instanceof Array && array[i] instanceof Array) {\n          if (!this[i].equals(array[i]))\n              return false;\n      }\n      else if (this[i] != array[i]) {\n          return false;\n      }\n  }\n  return true;\n}\n\nmodule.exports = View;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUs7QUFDcEIsUUFBUTtBQUNSO0FBQ0E7QUFDQSxpQkFBaUIsS0FBSztBQUN0QjtBQUNBLE1BQU07QUFDTixtQkFBbUI7QUFDbkIsTUFBTTtBQUNOOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsT0FBTztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSIsInNvdXJjZXMiOlsiLi9qcy9saWIvdmlldy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBUaWxlID0gcmVxdWlyZShcIi4vdGlsZVwiKTtcbmNvbnN0IFRyYXkgPSByZXF1aXJlKFwiLi90cmF5XCIpO1xuY29uc3QgU2hhcGUgPSByZXF1aXJlKFwiLi9zaGFwZVwiKTtcblxuLy9pbnRlcmFjdGlvbjogJ2FsbCcsICdtb25zdGVyJywgJ25vbmUnXG52YXIgVmlldyA9IGZ1bmN0aW9uIChnYW1lLCAkZWwsIGludGVyYWN0aW9uLCBpbWdSb290UGF0aD1cIlwiKSB7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG4gIHRoaXMuYm9hcmQgPSBnYW1lLmJvYXJkO1xuICB0aGlzLiRlbCA9ICRlbDtcbiAgdGhpcy5pbWdSb290UGF0aCA9IGltZ1Jvb3RQYXRoO1xuICB0aGlzLmludGVyYWN0aW9uID0gaW50ZXJhY3Rpb247XG5cbiAgLy9vbmUgdHJheSBhYm92ZVxuICB2YXIgJGNvbnRhaW5lciA9ICQoXCI8ZGl2PlwiKTtcbiAgJGNvbnRhaW5lci5hZGRDbGFzcygndHJheXMgZC1mbGV4IGZsZXgtcm93IGZsZXgtd3JhcCcpO1xuICB0aGlzLiRlbC5hcHBlbmQoJGNvbnRhaW5lcik7XG4gIHRoaXMuJHRyYXlFbCA9ICRjb250YWluZXI7XG5cbiAgdGhpcy5hY3RpdmVTaGFwZSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5ncmlkID0gW107XG4gIHRoaXMuc2V0dXBCb2FyZCgpO1xuXG4gICAvL29uZSB0cmF5IGJlbG93XG4gICRjb250YWluZXIgPSAkKFwiPGRpdj5cIik7XG4gICRjb250YWluZXIuYWRkQ2xhc3MoJ3RyYXlzIGQtZmxleCBmbGV4LXJvdyBmbGV4LXdyYXAnKTtcbiAgdGhpcy4kZWwuYXBwZW5kKCRjb250YWluZXIpO1xuICB0aGlzLiR0cmF5RWwyID0gJGNvbnRhaW5lcjtcblxuICB0aGlzLnNldHVwVHJheXMoKTtcbn07XG5cblZpZXcucHJvdG90eXBlLnNldHVwVHJheXMgPSBmdW5jdGlvbiAocGllY2VzKSB7XG4gIGZ1bmN0aW9uIHBsYWNlZFNoYXBlKHRyYXksIHNlbGYpIHtcbiAgICBpZiAoIXRyYXkgfHwgIXRyYXkuc2hhcGUucGxhY2VkfHwgIXRyYXkuc2hhcGUuY29ybmVyKSByZXR1cm47XG4gICAgY29uc3QgJHRyYXkgPSAkKFwiLlwiICsgdHJheS5jbGFzcyk7XG4gICAgY29uc3Qgc2hhcGUgPSB0cmF5LnNoYXBlO1xuXG4gICAgc2VsZi5hY3RpdmVTaGFwZSA9IHNoYXBlO1xuICAgIHNlbGYuYWN0aXZlVHJheSA9IHRyYXk7XG4gICAgaWYgKHNlbGYucGxhY2VTaGFwZUlmUG9zc2libGUoc2hhcGUuY29ybmVyKSkge1xuICAgICAgJHRyYXlbMF0uc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuICAgIH0gXG4gIH1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZ2FtZS50cmF5cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHRyYXkgPSB0aGlzLmdhbWUudHJheXNbaV07XG4gICAgdHJheS5fb3JkZXIgPSBpO1xuXG4gICAgdGhpcy5zZXR1cFBpZWNlVHJheSh0cmF5KTtcbiAgICBwbGFjZWRTaGFwZSh0cmF5LCB0aGlzKTtcbiAgfVxufVxuXG5WaWV3LnByb3RvdHlwZS5zZXR1cEJvYXJkID0gZnVuY3Rpb24gKCkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciAkdWwgPSAkKFwiPHVsPlwiKS5hZGRDbGFzcyhcImdyb3VwIHBvc2l0aW9uLXJlbGF0aXZlXCIpO1xuXG4gIGZ1bmN0aW9uIGlzQWN0aXZlVHJheUZvckNvb3Jkcyh0cmF5LCBpLCBqKSB7XG4gICAgaWYgKCF0cmF5IHx8IHNlbGYuaW50ZXJhY3Rpb24gPT0gJ25vbmUnKSByZXR1cm4gZmFsc2U7XG5cbiAgICBpZiAoKHNlbGYuaW50ZXJhY3Rpb24gPT0gJ21vbnN0ZXInICYmICF0cmF5LnNoYXBlLm1vbnN0ZXIpIFxuICAgIHx8IChzZWxmLmludGVyYWN0aW9uICE9ICdtb25zdGVyJyAmJiB0cmF5LnNoYXBlLm1vbnN0ZXIpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgY29vcmRzID0gdHJheS5zaGFwZS50cmFuc2Zvcm1Db29yZHM7XG4gICAgcmV0dXJuIGNvb3JkcyAmJiBjb29yZHMuc29tZShjID0+IFtpLCBqXS5lcXVhbHMoYykpO1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlQ291bnRlckNlbGwobGV0dGVyKSB7XG4gICAgdmFyICRsaSA9ICQoXCI8bGk+XCIpOyAgXG4gICAgJGxpLmNzcyh7d2lkdGg6IFRpbGUuc2l6ZSwgaGVpZ2h0OiBUaWxlLnNpemUsIGJhY2tncm91bmQ6ICd0cmFuc3BhcmVudCd9KVxuICAgICRsaS5odG1sKGxldHRlcik7XG4gICAgLy9uZWVkIHRvIGhhdmUgZHVlIHRvIHRlc3RpbmcsIGJ1dCBmYXIgYXdheSB0byBzYXkgJ25vdCBhYmxlIHRvIHBsYWNlJ1xuICAgICRsaS5kYXRhKFwicG9zXCIsIFstOTk5OTksLTk5OTk5XSk7XG4gICAgJGxpLmFkZENsYXNzKCdib3JkZXItY291bnRpbmcnKTtcbiAgICAkdWwuYXBwZW5kKCRsaSk7XG4gIH1cblxuICAvL2VtcHR5IGNvcm5lcjpcbiAgY3JlYXRlQ291bnRlckNlbGwoKTtcblxuICB0aGlzLmJvYXJkLmdyaWQuZm9yRWFjaChmdW5jdGlvbiAocm93LCByb3dJZHgpIHtcbiAgICBjcmVhdGVDb3VudGVyQ2VsbChTdHJpbmcuZnJvbUNoYXJDb2RlKHJvd0lkeCs2NSkpO1xuICB9KTtcblxuICB0aGlzLmJvYXJkLmdyaWQuZm9yRWFjaChmdW5jdGlvbiAocm93LCByb3dJZHgpIHtcbiAgICByb3cuZm9yRWFjaChmdW5jdGlvbiAodGlsZSwgdGlsZUlkeCkge1xuICAgICAgXG4gICAgICBpZiAodGlsZUlkeCA9PSAwKSB7XG4gICAgICAgIGNyZWF0ZUNvdW50ZXJDZWxsKHJvd0lkeCsxKTtcbiAgICAgIH1cblxuICAgICAgdmFyICRsaSA9ICQoXCI8bGk+XCIpO1xuICAgICAgY29uc3QgcG9zID0gW3Jvd0lkeCwgdGlsZUlkeF07XG5cbiAgICAgICRsaS5jc3Moe3dpZHRoOiBUaWxlLnNpemUsIGhlaWdodDogVGlsZS5zaXplfSlcbiAgICAgICRsaS5kYXRhKFwicG9zXCIsIHBvcyk7XG5cbiAgICAgIGNvbnN0IG1hcFBpZWNlID0gc2VsZi5nYW1lLm1hcFtyb3dJZHhdW3RpbGVJZHhdIHx8IHt9O1xuXG4gICAgICBpZiAobWFwUGllY2Uuc2NvcmQpIHsgLy9zcGVjaWFsIG5vbi1jb2xsaXNpb24gY29vcmRcbiAgICAgICAgJGxpLmRhdGEoXCJzY29yZFwiLCBtYXBQaWVjZS5zY29yZCk7XG4gICAgICAgICRsaS5hZGRDbGFzcygnc3BlY2lhbC1jb29yZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2VsZi5nYW1lLm1vdW50YWlucy5zb21lKG0gPT4gbS5lcXVhbHMocG9zKSkpIHsgLy9tb3VudGFpblxuICAgICAgICAkbGkuZGF0YShcImNvbG9yXCIsIHNlbGYuZ2FtZS5tb3VudGFpbkRhdGEuY29sb3IpO1xuICAgICAgICAkbGkuZGF0YShcImltYWdlXCIsIHNlbGYuZ2FtZS5tb3VudGFpbkRhdGEuaW1hZ2UpO1xuICAgICAgICAkbGkuY3NzKCdiYWNrZ3JvdW5kJywgXCJ1cmwoJ1wiKyBzZWxmLmltZ1Jvb3RQYXRoK3NlbGYuZ2FtZS5tb3VudGFpbkRhdGEuaW1hZ2UrXCInKVwiKTtcbiAgICAgICAgJGxpLmFkZENsYXNzKFwibW91bnRhaW5cIik7XG5cbiAgICAgIH0gZWxzZSBpZiAobWFwUGllY2UuY29sb3IpIHsgLy9vbGQgcGllY2VcbiAgICAgICAgJGxpLmRhdGEoXCJjb2xvclwiLCBtYXBQaWVjZS5jb2xvcik7XG4gICAgICAgICRsaS5kYXRhKFwiaW1hZ2VcIiwgbWFwUGllY2UuaW1hZ2UpO1xuICAgICAgICAkbGkuY3NzKCdiYWNrZ3JvdW5kJywgXCJ1cmwoJ1wiK3NlbGYuaW1nUm9vdFBhdGgrbWFwUGllY2UuaW1hZ2UrXCInKVwiKTtcblxuICAgICAgICBpZiAobWFwUGllY2UubW9uc3Rlcikge1xuICAgICAgICAgICRsaS5hZGRDbGFzcygnbW9uc3RlcicpO1xuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSB7IC8vZW1wdHlcbiAgICAgICAgXG4gICAgICAgICRsaS5hZGRDbGFzcygnZHJvcHpvbmUnKTtcblxuICAgICAgICAgIHNlbGYuYWRkRHJvcHBhYmxlTGlzdGVuZXIoJGxpKTsgIFxuICAgICAgICAgICRsaS5vbignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgLy9leGlzdGluZyBzaGFwZXMgY2FuIGJlIHJlbW92ZWRcbiAgICAgICAgICAgIGNvbnN0IHRyYXkgPSBzZWxmLmdhbWUudHJheXMuZmluZCh0cmF5ID0+IGlzQWN0aXZlVHJheUZvckNvb3Jkcyh0cmF5LCByb3dJZHgsIHRpbGVJZHgpKTtcbiAgICBcbiAgICAgICAgICAgIGlmICh0cmF5KSB7XG4gICAgICAgICAgICAgIHNlbGYucmV2ZXJ0UmVuZGVyKHRyYXkuc2hhcGUpO1xuICAgICAgICAgICAgICBzZWxmLnNldHVwUGllY2VUcmF5KHRyYXkpO1xuICAgICAgICAgICAgICB0cmF5LnNoYXBlLnBsYWNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICB0cmF5LnNoYXBlLmNvcm5lciA9IHVuZGVmaW5lZDsgXG4gICAgICAgICAgICAgIHRyYXkuc2hhcGUudHJhbnNmb3JtQ29vcmRzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgICR1bC5hcHBlbmQoJGxpKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgJHVsLmNzcygnd2lkdGgnLCAodGhpcy5ib2FyZC5zaXplKzEpICogKFRpbGUuc2l6ZSsxKSArIDUpO1xuXG4gIHRoaXMuJGVsLmFwcGVuZCgkdWwpO1xufTtcblxuVmlldy5wcm90b3R5cGUuYWRkRHJvcHBhYmxlTGlzdGVuZXIgPSBmdW5jdGlvbiAoJGxpKSB7XG5cbiAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gIGludGVyYWN0KCcuZHJvcHpvbmUnKS5kcm9wem9uZSh7XG4gICAgLy8gUmVxdWlyZSBhIDc1JSBlbGVtZW50IG92ZXJsYXAgZm9yIGEgZHJvcCB0byBiZSBwb3NzaWJsZVxuICAgIG92ZXJsYXA6IDAuNCxcbiAgXG4gXG4gICAgLy8gb25kcm9wYWN0aXZhdGU6IGZ1bmN0aW9uIChldmVudCkge1xuICAgIC8vICAgc2VsZi5hY3RpdmVUcmF5ID0gdHJheTtcbiAgICAvLyB9LFxuICAgIG9uZHJhZ2VudGVyOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIHZhciBkcmFnZ2FibGVFbGVtZW50ID0gZXZlbnQucmVsYXRlZFRhcmdldFxuICAgICAgdmFyIGRyb3B6b25lRWxlbWVudCA9IGV2ZW50LnRhcmdldFxuICAgICAgLy8gZmVlZGJhY2sgdGhlIHBvc3NpYmlsaXR5IG9mIGEgZHJvcFxuICAgICAgZHJvcHpvbmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Ryb3AtdGFyZ2V0JylcbiAgICAgIGRyYWdnYWJsZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2FuLWRyb3AnKVxuXG4gICAgfSxcbiAgICBvbmRyYWdsZWF2ZTogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAvLyByZW1vdmUgdGhlIGRyb3AgZmVlZGJhY2sgc3R5bGVcbiAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wLXRhcmdldCcpXG4gICAgICBldmVudC5yZWxhdGVkVGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2Nhbi1kcm9wJylcblxuXG4gICAgfSxcbiAgICBvbmRyb3A6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgY29uc3QgZHJhZ1RhcmdldCA9ICQoZXZlbnQucmVsYXRlZFRhcmdldCkuZGF0YSgncG9zJyk7XG4gICAgICBjb25zdCBkcm9wVGFyZ2V0ID0gJChldmVudC50YXJnZXQpLmRhdGEoJ3BvcycpO1xuXG4gICAgICAvL3dlIG1pZ2h0IGJlIGRyYWdnaW5nIGJ5IGVsZW1lbnQgWzIsM10gLT4gYWx3YXlzIGdldCBsZWZ0IHRvcFxuICAgICAgY29uc3QgY29ybmVyID0gW2Ryb3BUYXJnZXRbMF0tZHJhZ1RhcmdldFswXSwgZHJvcFRhcmdldFsxXS1kcmFnVGFyZ2V0WzFdXTtcbiAgXG4gICAgICBpZiAoc2VsZi5wbGFjZVNoYXBlSWZQb3NzaWJsZShjb3JuZXIpKSB7XG4gICAgICAgXG4gICAgICAgIHNlbGYuYWN0aXZlU2hhcGUucGxhY2VkID0gdHJ1ZTtcbiAgICAgICAgc2VsZi5hY3RpdmVTaGFwZS5jb3JuZXIgPSBjb3JuZXI7XG4gICAgICAgIGV2ZW50LnJlbGF0ZWRUYXJnZXQucGFyZW50RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICB9XG4gICAgfSxcbiAgICBvbmRyb3BkZWFjdGl2YXRlOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIC8vIHJlbW92ZSBhY3RpdmUgZHJvcHpvbmUgZmVlZGJhY2tcbiAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wLXRhcmdldCcpXG4gICAgfVxuICB9KVxuXG59O1xuXG5WaWV3LnByb3RvdHlwZS5nZXRDdXJyZW50SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmdhbWUudHJheXMubWFwKHQgPT4gdC5zaGFwZS5leHBvcnQoKSk7XG59XG5cblxuVmlldy5wcm90b3R5cGUudHJhbnNmb3JtQ29vcmRzID0gZnVuY3Rpb24gKHN0YXJ0UG9zLCBjb29yZHMpIHtcbiAgcmV0dXJuIGNvb3Jkcy5tYXAoZnVuY3Rpb24gKHBvcykge1xuICAgIHJldHVybiBbc3RhcnRQb3NbMF0rcG9zWzBdLCBzdGFydFBvc1sxXStwb3NbMV1dO1xuICB9KTtcbn07XG5cblZpZXcucHJvdG90eXBlLnJldmVydFJlbmRlciA9IGZ1bmN0aW9uIChzaGFwZSkge1xuICBpZiAoIXNoYXBlLmNvcm5lciB8fCAhc2hhcGUudHJhbnNmb3JtQ29vcmRzKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkF0dGVtcHQgdG8gcmV2ZXJ0IHVucGxhY2VkIHRpbGUhXCIsIHNoYXBlKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBzZWxmID0gdGhpcztcbiAgJCgnLmdyb3VwID4gbGknKS5lYWNoKGZ1bmN0aW9uIChpZHgsIGxpKSB7XG4gICAgdmFyICRsaSA9ICQobGkpO1xuICAgIHNoYXBlLnRyYW5zZm9ybUNvb3Jkcy5mb3JFYWNoKGZ1bmN0aW9uIChwb3MsIGkpIHtcbiAgICAgIGlmIChwb3MuZXF1YWxzKCRsaS5kYXRhKCdwb3MnKSkpIHtcbiAgICAgICAgJGxpLmNzcyhcImJhY2tncm91bmRcIiwgXCJcIik7XG4gICAgICAgICRsaS5jc3MoJ291dGxpbmUnLCAndW5zZXQnKTtcbiAgICAgICAgJGxpLnJlbW92ZURhdGEoJ2NvbG9yJyk7XG4gICAgICAgICRsaS5yZW1vdmVDbGFzcygnYWN0aXZlIG1vbnN0ZXInKTsgLy9tb25zdGVyIC0ganVzdCB0byBiZSBzdXJlXG4gICAgICB9ICBcbiAgICB9KTtcblxuICAgIGlmIChzaGFwZT8uc2Nvb3Jkcykge1xuICAgICAgZm9yIChsZXQgcG9zIG9mIHNlbGYudHJhbnNmb3JtQ29vcmRzKHNoYXBlLmNvcm5lciwgc2hhcGUuc2Nvb3JkcykpIHtcbiAgICAgICAgaWYgKHBvcy5lcXVhbHMoJGxpLmRhdGEoJ3BvcycpKSkge1xuICAgICAgICAgICRsaS5yZW1vdmVDbGFzcygnc3BlY2lhbC1jb29yZCcpO1xuICAgICAgICB9XG4gICAgICAgXG4gICAgICB9XG4gICAgfVxuICBcbiAgfSk7IFxuICAkKCcuJytzaGFwZS50cmF5LmNsYXNzKS5jc3MoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG59O1xuXG5WaWV3LnByb3RvdHlwZS5wbGFjZVNoYXBlSWZQb3NzaWJsZSA9IGZ1bmN0aW9uIChzdGFydFBvcykge1xuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgdGhpcy5hY3RpdmVTaGFwZSA9IHRoaXMuYWN0aXZlVHJheS5zaGFwZTtcblxuICB2YXIgY29vcmRzID0gdGhpcy5hY3RpdmVTaGFwZS5jb29yZHM7XG4gIHZhciBtYXhMZW4gPSB0aGlzLmdhbWUuYm9hcmQuc2l6ZTtcblxuICB0aGlzLmFjdGl2ZVNoYXBlLnRyYW5zZm9ybUNvb3JkcyA9IHRoaXMudHJhbnNmb3JtQ29vcmRzKHN0YXJ0UG9zLCBjb29yZHMpO1xuICBmb3IgKGxldCBwb3Mgb2YgdGhpcy5hY3RpdmVTaGFwZS50cmFuc2Zvcm1Db29yZHMpIHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlU2hhcGUgfHwgcG9zWzBdIDwgMCB8fCBwb3NbMV0gPCAwIHx8IHBvc1swXSA+PSBtYXhMZW4gfHwgcG9zWzFdID49IG1heExlbikge1xuICAgICAgdGhpcy5hY3RpdmVTaGFwZSA9IHVuZGVmaW5lZDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgJCgnLmdyb3VwID4gbGknKS5lYWNoKGZ1bmN0aW9uIChpZHgsIGxpKSB7XG4gICAgICB2YXIgJGxpID0gJChsaSk7XG4gICAgICBpZiAoIXBvcy5lcXVhbHMoJGxpLmRhdGEoJ3BvcycpKSkgcmV0dXJuO1xuICAgICAgaWYgKCgkbGkuZGF0YSgnY29sb3InKSAhPT0gdW5kZWZpbmVkKSkge1xuICAgICAgICBzZWxmLmFjdGl2ZVNoYXBlID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgaWYgKCF0aGlzLmFjdGl2ZVNoYXBlKSByZXR1cm4gZmFsc2U7XG4gIC8vZWxzZSByZW5kZXJcblxuICB2YXIgY29sb3IgPSB0aGlzLmFjdGl2ZVNoYXBlLmNvbG9yO1xuICB2YXIgaW1hZ2UgPSB0aGlzLmFjdGl2ZVNoYXBlLmltYWdlO1xuICB2YXIgbW9uc3RlciA9IHRoaXMuYWN0aXZlU2hhcGUubW9uc3RlcjtcblxuICAkKCcuZ3JvdXAgPiBsaScpLmVhY2goZnVuY3Rpb24gKGlkeCwgbGkpIHtcbiAgICBjb25zdCAkbGkgPSAkKGxpKSxcbiAgICAgIHRpbGVQb3MgPSAkbGkuZGF0YSgncG9zJyk7XG5cbiAgICBmb3IgKGxldCBwb3Mgb2Ygc2VsZi5hY3RpdmVTaGFwZS50cmFuc2Zvcm1Db29yZHMpIHtcbiAgICAgIGlmIChwb3MuZXF1YWxzKHRpbGVQb3MpKSB7XG4gICAgICAgICRsaS5jc3MoJ2JhY2tncm91bmQnLCBcInVybCgnXCIrc2VsZi5pbWdSb290UGF0aCtpbWFnZStcIicpXCIpO1xuICAgICAgICAkbGkuZGF0YSgnY29sb3InLCBjb2xvcik7XG4gICAgICAgICRsaS5jc3MoJ291dGxpbmUnLCAnMXB4IHNvbGlkICcgKyBjb2xvcik7XG4gICAgICAgICRsaS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgaWYgKG1vbnN0ZXIpIHtcbiAgICAgICAgICAkbGkuYWRkQ2xhc3MoJ21vbnN0ZXInKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzZWxmLmFjdGl2ZVNoYXBlPy5zY29vcmRzKSB7XG4gICAgICBmb3IgKGxldCBwb3Mgb2Ygc2VsZi50cmFuc2Zvcm1Db29yZHMoc3RhcnRQb3MsIHNlbGYuYWN0aXZlU2hhcGUuc2Nvb3JkcykpIHtcbiAgICAgICAgaWYgKHBvcy5lcXVhbHModGlsZVBvcykpIHtcbiAgICAgICAgICAkbGkuYWRkQ2xhc3MoJ3NwZWNpYWwtY29vcmQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgdGhpcy5nYW1lLnBsYXlNb3ZlKCk7XG4gIHJldHVybiB0cnVlO1xufTtcblxuVmlldy5wcm90b3R5cGUuZnVsbCA9IGZ1bmN0aW9uIChhcnIpIHtcbiAgdmFyIGZ1bGwgPSB0cnVlO1xuICBhcnIuZm9yRWFjaChmdW5jdGlvbiAobGkpIHtcbiAgICB2YXIgJGxpID0gJChsaSk7XG4gICAgaWYgKCRsaS5kYXRhKCdjb2xvcicpID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGZ1bGwgPSBmYWxzZTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gZnVsbDtcbn07XG5cbi8vIFZpZXcucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKGFycikge1xuLy8gICB0aGlzLmdhbWUuc2NvcmUgKz0gOTNcbi8vICAgdmFyIHNlbGYgPSB0aGlzO1xuLy8gICBhcnIuZm9yRWFjaChmdW5jdGlvbiAobGkpIHtcbi8vICAgICB2YXIgJGxpID0gJChsaSk7XG4vLyAgICAgJGxpLmFuaW1hdGUoeyAnYmFja2dyb3VuZCc6ICcjY2NjJyB9LCA1MDAsIGZ1bmN0aW9uKCkge1xuLy8gICAgICAgJGxpLnJlbW92ZUF0dHIoJ3N0eWxlJyk7XG4vLyAgICAgICAkbGkucmVtb3ZlRGF0YSgnY29sb3InKTtcbi8vICAgICAgICRsaS5yZW1vdmVDbGFzcygncGllY2UnKTtcbi8vIFx0XHR9KTtcbi8vICAgfSk7XG5cbi8vICAgcmV0dXJuIHRydWU7XG4vLyB9O1xuXG5WaWV3LnByb3RvdHlwZS5zZXR1cFBpZWNlVHJheSA9IGZ1bmN0aW9uICh0cmF5KSB7XG5cbiAgY29uc3QgJHBhcmVudCA9IHRyYXkuX29yZGVyID4gMiA/IHRoaXMuJHRyYXlFbDIgOiB0aGlzLiR0cmF5RWw7XG5cbiAgaWYgKCF0cmF5KSB7XG4gICAgdmFyICRjID0gJChcIjx1bCBjbGFzcz0nZC1mbGV4IGJvcmRlci0xIHJvdW5kZWQtMiBwLTEgbS0xIHBvc2l0aW9uLXJlbGF0aXZlJz5cIik7XG4gICAgJGMuY3NzKCdkaXNwbGF5JywgJ2lubGluZS1ibG9jaycpO1xuICAgICRjLmNzcygnYmFja2dyb3VuZCcsICcjZWVlYScpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBUcmF5LnNpemU7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBUcmF5LnNpemU7IGorKykge1xuICAgICAgICB2YXIgJGxpID0gJChcIjxsaT5cIik7XG4gICAgICAgICRsaS5jc3Moe3dpZHRoOiBUaWxlLnNpemUsIGhlaWdodDogVGlsZS5zaXplfSlcbiAgXG4gICAgICAgIGlmICgoaStqKSUzPT0wKSB7XG4gICAgICAgICAgJGxpLmNzcygnYmFja2dyb3VuZCcsIFwiY29sb3I6I2NjY1wiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkbGkuY3NzKCdiYWNrZ3JvdW5kJywgJ3RyYW5zcGFyZW50Jyk7XG4gICAgICAgIH1cbiAgXG4gICAgICAgICRsaS5kYXRhKFwicG9zXCIsIFstMSwtMV0pO1xuICAgICAgICAkYy5hcHBlbmQoJGxpKTtcbiAgICAgIH1cbiAgICB9XG4gICAgJGMuY3NzKCd3aWR0aCcsIFRyYXkuc2l6ZSAqIChUaWxlLnNpemUrMSkgKyAxMCk7XG4gICAgJHBhcmVudC5hcHBlbmQoJGMpO1xuICAgIHJldHVybjtcbiAgfVxuXG5cbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgJHVsID0gJChcIjx1bCBjbGFzcz0nYm9yZGVyLTEgcm91bmRlZC0xIHAtMSBtLTEgcG9zaXRpb24tcmVsYXRpdmUnPlwiKTtcbiAgJHVsLmFkZENsYXNzKHRyYXkuY2xhc3MpO1xuICAkdWwuY3NzKCdiYWNrZ3JvdW5kJywgJyNlZWVhJyk7XG4gICR1bC5jc3MoJ3otaW5kZXgnLCAnOTk5Jyk7XG5cbiAgdHJheS5ncmlkLmZvckVhY2goZnVuY3Rpb24gKHJvdywgcm93SWR4KSB7XG4gICAgcm93LmZvckVhY2goZnVuY3Rpb24gKHRpbGUsIHRpbGVJZHgpIHtcbiAgICAgIHZhciAkbGkgPSAkKFwiPGxpPlwiKTtcbiAgICAgICRsaS5jc3Moe3dpZHRoOiBUaWxlLnNpemUsIGhlaWdodDogVGlsZS5zaXplfSk7XG5cbiAgICAgIGlmICh0aWxlLnNjb3JkKSB7IC8vc3BlY2lhbCBub24tY29sbGlzaW9uIGNvb3JkXG4gICAgICAgICRsaS5kYXRhKFwic2NvcmRcIiwgdGlsZS5zY29yZCk7XG4gICAgICAgICRsaS5hZGRDbGFzcygnc3BlY2lhbC1jb29yZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRpbGUuZW1wdHkpIHtcbiAgICAgICAgJGxpLmRhdGEoXCJjb2xvclwiLCB0aWxlLmNvbG9yKTtcbiAgICAgICAgJGxpLmRhdGEoXCJpbWFnZVwiLCB0aWxlLmltYWdlKTtcbiAgICAgICAgJGxpLmNzcygnYmFja2dyb3VuZCcsIFwidXJsKCdcIitzZWxmLmltZ1Jvb3RQYXRoK3RpbGUuaW1hZ2UrXCInKVwiKTtcbiAgICAgICAgJGxpLmFkZENsYXNzKFwicGllY2VcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkbGkuY3NzKCdiYWNrZ3JvdW5kJywgJ3RyYW5zcGFyZW50Jyk7XG4gICAgICB9XG5cbiAgICAgICRsaS5kYXRhKFwicG9zXCIsIFtyb3dJZHgsIHRpbGVJZHhdKTtcbiAgICAgICR1bC5hcHBlbmQoJGxpKTtcbiAgICB9KTtcbiAgfSk7XG4gICR1bC5jc3MoJ3dpZHRoJywgdHJheS5zaXplICogKFRpbGUuc2l6ZSsxKSArIDEwKTtcblxuXG4gIHZhciB0aW1lciA9IDA7XG4gIGZ1bmN0aW9uIHBvaW50RG93bigpIHtcbiAgICB0aW1lciA9IERhdGUubm93KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwb2ludFVwKCkge1xuICAgIGNvbnN0IGQgPSBEYXRlLm5vdygpIC0gdGltZXI7XG4gICAgdGltZXIgPSAwO1xuXG4gICAgY29uc3QgbW92ZWQgPSAkdWxbMF0uX21vdmluZztcbiAgICAkdWxbMF0uX21vdmluZz1mYWxzZTtcbiAgICBpZiAoJHVsLmNzcygndmlzaWJpbGl0eScpIT0ndmlzaWJsZScgfHwgbW92ZWQpIHJldHVybjtcbiAgICBcbiAgICBpZiAoZCA8IDEyMCkge1xuICAgICAgdHJheS5yb3RhdGVSaWdodCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0cmF5LmZsaXAoKTtcbiAgICB9XG4gICAgc2VsZi5zZXR1cFBpZWNlVHJheSh0cmF5KTtcbiAgfVxuXG4gICR1bFswXS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBwb2ludERvd24sIGZhbHNlKTtcbiAgJHVsWzBdLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgcG9pbnRVcCxmYWxzZSk7XG5cbiAgJHVsLm9uKCdjbGljaycsIGUgPT4ge1xuICAgIFxuICB9KVxuXG4gICRlbGVtID0gJChgLiR7dHJheS5jbGFzc31gKTtcbiAgaWYgKCRlbGVtLmxlbmd0aCkge1xuICAgICRlbGVtLnJlcGxhY2VXaXRoKCR1bCk7XG4gIH0gZWxzZSB7XG4gICAgdmFyICRjID0gJChcIjxkaXY+XCIpO1xuICAgICRjLmNzcygnZGlzcGxheScsICdpbmxpbmUtYmxvY2snKTtcbiAgICAkYy5hcHBlbmQoJHVsKTtcbiAgICAkcGFyZW50LmFwcGVuZCgkYyk7XG4gIH1cblxuICB0aGlzLmFkZERyYWdnYWJsZUxpc3RlbmVyKHRyYXkpO1xufTtcblxuXG5WaWV3LnByb3RvdHlwZS5hZGREcmFnZ2FibGVMaXN0ZW5lciA9IGZ1bmN0aW9uICh0cmF5KSB7XG5cbiAgY29uc3QgY2xzID0gdHJheS5jbGFzcztcbiAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgaWYgKHRoaXMuaW50ZXJhY3Rpb24gPT0gJ25vbmUnKSByZXR1cm47XG4gIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5pbnRlcmFjdGlvbiA9PSAnbW9uc3RlcicgPyBgLiR7Y2xzfSA+IGxpLm1vbnN0ZXJgIDogYC4ke2Nsc30gPiBsaS5waWVjZWA7XG4gIFxuICBpbnRlcmFjdChgLiR7Y2xzfSA+IGxpLnBpZWNlYCkuZHJhZ2dhYmxlKHtcbiAgICBpbmVydGlhOiB0cnVlLFxuICAgIG1vZGlmaWVyczogW1xuICAgICAgaW50ZXJhY3QubW9kaWZpZXJzLnJlc3RyaWN0UmVjdCh7XG4gICAgICAgIHJlc3RyaWN0aW9uOiAncGFyZW50JyxcbiAgICAgICAgZW5kT25seTogdHJ1ZVxuICAgICAgfSlcbiAgICBdLFxuICAgIGF1dG9TY3JvbGw6IHRydWUsXG4gICAgLy8gZHJhZ01vdmVMaXN0ZW5lciBmcm9tIHRoZSBkcmFnZ2luZyBkZW1vIGFib3ZlXG4gICAgbGlzdGVuZXJzOiB7IFxuICAgICAgbW92ZTogKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBldmVudC50YXJnZXQucGFyZW50RWxlbWVudDtcbiAgICAgICAgLy8ga2VlcCB0aGUgZHJhZ2dlZCBwb3NpdGlvbiBpbiB0aGUgZGF0YS14L2RhdGEteSBhdHRyaWJ1dGVzXG4gICAgICAgIHZhciB4ID0gKHBhcnNlRmxvYXQobm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEteCcpKSB8fCAwKSArIGV2ZW50LmR4XG4gICAgICAgIHZhciB5ID0gKHBhcnNlRmxvYXQobm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEteScpKSB8fCAwKSArIGV2ZW50LmR5XG4gICAgICBcbiAgICAgICAgLy8gdHJhbnNsYXRlIHRoZSBlbGVtZW50XG4gICAgICAgIG5vZGUuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgnICsgeCArICdweCwgJyArIHkgKyAncHgpJ1xuICAgICAgXG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgcG9zaWlvbiBhdHRyaWJ1dGVzXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdkYXRhLXgnLCB4KVxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgnZGF0YS15JywgeSlcbiAgICAgIH0sXG4gICAgICBzdGFydDogKGV2ZW50KSA9PiB7XG4gICAgICAgIHNlbGYuYWN0aXZlVHJheSA9IHRyYXk7XG4gICAgICAgIHRpbWVyID0gRGF0ZS5ub3coKTtcblxuICAgICAgICBjb25zdCBub2RlID0gZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIG5vZGUuX21vdmluZz10cnVlO1xuICAgICAgICBub2RlLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuICAgICAgICBzZWxmLiRlbC5jc3Moe1xuICAgICAgICAgIFwidG91Y2gtYWN0aW9uXCI6IFwibm9uZVwiLCBcInVzZXItc2VsZWN0XCI6IFwibm9uZVwiXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgIH1cbiAgICB9XG4gIH0pLm9uKCdkcmFnZW5kJywgZXZlbnQ9PiB7XG4gICAgc2VsZi5hY3RpdmVUcmF5ID0gbnVsbDtcblxuICAgIGNvbnN0IG5vZGUgPSBldmVudC50YXJnZXQucGFyZW50RWxlbWVudDtcbiAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9ICdpbml0aWFsJztcbiAgICBub2RlLnNldEF0dHJpYnV0ZSgnZGF0YS14JywgMCk7XG4gICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ2RhdGEteScsIDApO1xuICAgIG5vZGUuc3R5bGUuYmFja2dyb3VuZCA9ICcjZWVlYSc7XG5cbiAgICBzZWxmLiRlbC5jc3Moe1xuICAgICAgXCJ0b3VjaC1hY3Rpb25cIjogXCJcIiwgXCJ1c2VyLXNlbGVjdFwiOiBcIlwiXG4gICAgfSk7XG4gIH0pXG4gIFxuXG5cbiAgLy8gJChgLiR7Y2xzfSA+IGxpLnBpZWNlYCkuZHJhZ2dhYmxlKHtcbiAgLy8gICBjdXJzb3I6ICdwb2ludGVyJyxcbiAgLy8gICByZXZlcnQ6IGZhbHNlLFxuICAvLyAgIGhlbHBlcjogZnVuY3Rpb24oZSkge1xuICAvLyAgICAgdmFyIGhlbHBlckxpc3QgPSAkKCc8dWwgY2xhc3M9XCJkcmFnZ2FibGUtaGVscGVyXCI+Jyk7XG4gIC8vICAgICBoZWxwZXJMaXN0LmFwcGVuZCgkKGAuJHtjbHN9ID4gbGlgKS5jbG9uZSgpKTtcbiAgLy8gICAgIHJldHVybiBoZWxwZXJMaXN0O1xuICAvLyAgIH0sXG4gIC8vICAgc3RhcnQ6IGZ1bmN0aW9uIChlLCB1aSkge1xuICAvLyAgICAgc2VsZi5hY3RpdmVUcmF5ID0gdHJheTtcbiAgLy8gICB9LFxuICAvLyAgIGRyYWc6IGZ1bmN0aW9uIChlLCB1aSkge1xuICAvLyAgICAgJChgLiR7Y2xzfSA+IGxpLnBpZWNlYCkuY3NzKCd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICAvLyAgIH0sXG4gIC8vICAgc3RvcDogZnVuY3Rpb24oZSwgdWkpIHtcbiAgLy8gICAgIGlmICghc2VsZi5hY3RpdmVTaGFwZSkge1xuICAvLyAgICAgICAkKGAuJHtjbHN9ID4gbGkucGllY2VgKS5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICAvLyAgICAgfVxuXHQvLyBcdH0sXG4gIC8vICAgY3Vyc29yQXQ6IHsgdG9wOiA0MCB9XG4gIC8vIH0pO1xufTtcblxuQXJyYXkucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICBpZiAoIWFycmF5KVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICBpZiAodGhpcy5sZW5ndGggIT0gYXJyYXkubGVuZ3RoKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICBmb3IgKHZhciBpID0gMCwgbD10aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgaWYgKHRoaXNbaV0gaW5zdGFuY2VvZiBBcnJheSAmJiBhcnJheVtpXSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgaWYgKCF0aGlzW2ldLmVxdWFscyhhcnJheVtpXSkpXG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHRoaXNbaV0gIT0gYXJyYXlbaV0pIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gVmlldztcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///301\n")},367:(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{eval('var View = __webpack_require__(301);\nvar Game = __webpack_require__(743);\n\nwindow.kartografove = function(rootEl, map, items, interaction, mountainData={color:"brown", image:"mountain.png"}, mountains=[[1,9],[3,2],[5,8],[7,4],[9,1]]) {\n  //map: 2D array of nodes: {image, color }\n  //items: 1D array of active pieces: {image, color, pos:[[point]], corner:[point], placed:bool}\n  //can optionally receive mountain spec and mountain array of positions\n  //colors: they need to be a) valid value for nonempty tile (nonempty string), b) do not have to be consistent, colors are used for borders only \n  var game = new Game(map, items, mountainData, mountains);\n  window.view = new View(game, rootEl, interaction, "img/");\n  game.run();\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzY3LmpzIiwibWFwcGluZ3MiOiJBQUFBLFdBQVcsbUJBQU8sQ0FBQyxHQUFZO0FBQy9CLFdBQVcsbUJBQU8sQ0FBQyxHQUFZOztBQUUvQiw4RUFBOEUsb0NBQW9DO0FBQ2xILDZCQUE2QjtBQUM3Qix1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIuL2pzL21haW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIFZpZXcgPSByZXF1aXJlKCcuL2xpYi92aWV3Jyk7XG52YXIgR2FtZSA9IHJlcXVpcmUoJy4vbGliL2dhbWUnKTtcblxud2luZG93LmthcnRvZ3JhZm92ZSA9IGZ1bmN0aW9uKHJvb3RFbCwgbWFwLCBpdGVtcywgaW50ZXJhY3Rpb24sIG1vdW50YWluRGF0YT17Y29sb3I6XCJicm93blwiLCBpbWFnZTpcIm1vdW50YWluLnBuZ1wifSwgbW91bnRhaW5zPVtbMSw5XSxbMywyXSxbNSw4XSxbNyw0XSxbOSwxXV0pIHtcbiAgLy9tYXA6IDJEIGFycmF5IG9mIG5vZGVzOiB7aW1hZ2UsIGNvbG9yIH1cbiAgLy9pdGVtczogMUQgYXJyYXkgb2YgYWN0aXZlIHBpZWNlczoge2ltYWdlLCBjb2xvciwgcG9zOltbcG9pbnRdXSwgY29ybmVyOltwb2ludF0sIHBsYWNlZDpib29sfVxuICAvL2NhbiBvcHRpb25hbGx5IHJlY2VpdmUgbW91bnRhaW4gc3BlYyBhbmQgbW91bnRhaW4gYXJyYXkgb2YgcG9zaXRpb25zXG4gIC8vY29sb3JzOiB0aGV5IG5lZWQgdG8gYmUgYSkgdmFsaWQgdmFsdWUgZm9yIG5vbmVtcHR5IHRpbGUgKG5vbmVtcHR5IHN0cmluZyksIGIpIGRvIG5vdCBoYXZlIHRvIGJlIGNvbnNpc3RlbnQsIGNvbG9ycyBhcmUgdXNlZCBmb3IgYm9yZGVycyBvbmx5IFxuICB2YXIgZ2FtZSA9IG5ldyBHYW1lKG1hcCwgaXRlbXMsIG1vdW50YWluRGF0YSwgbW91bnRhaW5zKTtcbiAgd2luZG93LnZpZXcgPSBuZXcgVmlldyhnYW1lLCByb290RWwsIGludGVyYWN0aW9uLCBcImltZy9cIik7XG4gIGdhbWUucnVuKCk7XG59O1xuXG5cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///367\n')}},__webpack_module_cache__={};function __webpack_require__(n){var c=__webpack_module_cache__[n];if(void 0!==c)return c.exports;var I=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n](I,I.exports,__webpack_require__),I.exports}var __webpack_exports__=__webpack_require__(367)})();